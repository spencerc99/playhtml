<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PlayHTML Admin Console</title>
    <link rel="stylesheet" href="../base.scss" />
    <link rel="stylesheet" href="admin.scss" />
  </head>
  <body>
    <div class="admin-container">
      <header class="admin-header">
        <h1>üõ†Ô∏è PlayHTML Admin Console</h1>
        <div class="auth-controls">
          <button id="authBtn" class="auth-btn">üîê Authenticate</button>
          <span id="authStatus" class="auth-status">Not authenticated</span>
        </div>
      </header>

      <div class="admin-content" id="adminContent" style="display: none">
        <section class="room-inspector">
          <h2>Room Inspector</h2>
          <div class="input-group">
            <label for="roomId">Room ID:</label>
            <input
              type="text"
              id="roomId"
              placeholder="Enter room ID to inspect..."
            />
            <button id="loadRoom">Load Room</button>
          </div>

          <div id="roomStatus" class="status-display"></div>

          <div id="ydocData" class="data-section">
            <h3>Y.Doc Data</h3>
            <div id="ydocViewer" class="interactive-json-viewer"></div>
          </div>

          <div id="metaData" class="data-section">
            <h3>Room Metadata</h3>
            <div id="metaViewer" class="data-viewer"></div>
          </div>

          <div id="sharedData" class="data-section">
            <h3>Shared Data</h3>
            <div class="shared-data-grid">
              <div class="shared-section">
                <h4>Subscribers</h4>
                <div id="subscribersViewer" class="data-viewer"></div>
              </div>
              <div class="shared-section">
                <h4>Shared References</h4>
                <div id="referencesViewer" class="data-viewer"></div>
              </div>
              <div class="shared-section">
                <h4>Permissions</h4>
                <div id="permissionsViewer" class="data-viewer"></div>
              </div>
            </div>
          </div>

          <div id="rawDbData" class="data-section" style="display: none">
            <h3>Raw Database Data</h3>
            <div class="debug-info">
              <div class="debug-item">
                <strong>Document Size:</strong>
                <span id="docSize">-</span>
              </div>
              <div class="debug-item">
                <strong>Base64 Length:</strong>
                <span id="base64Length">-</span>
              </div>
              <div class="debug-item">
                <strong>Last Updated:</strong>
                <span id="dbTimestamp">-</span>
              </div>
            </div>
            <div id="rawDataViewer" class="interactive-json-viewer"></div>
          </div>

          <div id="ydocDebug" class="data-section" style="display: none">
            <h3>Y.Doc Loading Debug</h3>
            <div id="debugSteps" class="debug-steps"></div>
            <div id="reconstructedDoc" class="interactive-json-viewer"></div>
          </div>

          <div id="dataComparison" class="data-section" style="display: none">
            <h3>Live vs Admin Data Comparison</h3>
            <div class="debug-info">
              <div class="debug-item">
                <strong>Direct Method Keys:</strong>
                <span id="directKeyCount">-</span>
              </div>
              <div class="debug-item">
                <strong>Live Method Keys:</strong>
                <span id="liveKeyCount">-</span>
              </div>
              <div class="debug-item">
                <strong>Data Match:</strong>
                <span id="dataMatch">-</span>
              </div>
            </div>
            <div class="shared-data-grid">
              <div class="shared-section">
                <h4>Direct Method Data (Admin Console)</h4>
                <div
                  id="directDataViewer"
                  class="interactive-json-viewer"
                ></div>
              </div>
              <div class="shared-section">
                <h4>Live Method Data (unstable_getYDoc)</h4>
                <div id="liveDataViewer" class="interactive-json-viewer"></div>
              </div>
            </div>
          </div>
        </section>

        <section class="debug-tools">
          <h2>Debug Tools</h2>
          <div class="tool-grid">
            <button id="exportData" class="tool-btn" disabled>
              Export Room Data
            </button>
            <button id="loadRawData" class="tool-btn" disabled>
              Load Raw DB Data
            </button>
            <button id="debugYDoc" class="tool-btn" disabled>
              Debug Y.Doc Loading
            </button>
            <button id="compareDataMethods" class="tool-btn" disabled>
              Compare Live vs Admin Data
            </button>
          </div>
        </section>

        <section class="logs-section">
          <h2>Debug Logs</h2>
          <div class="log-controls">
            <button id="clearLogs">Clear Logs</button>
            <label>
              <input type="checkbox" id="autoScroll" checked /> Auto-scroll
            </label>
          </div>
          <div id="logOutput" class="log-output"></div>
        </section>
      </div>
    </div>

    <script type="module" src="admin.ts"></script>
  </body>
</html>
